<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"  
    xml:lang="en" lang="en">
  <head>
    <title>Using multiple processor cores in R-Projet</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="content-language" content="en" />
    <link rel="stylesheet" href="http://.//css/main.css" type="text/css"
  </head>
  <body  style="background-image: url(&quot;./images/index_bg.jpg&quot;);">
  
    <h1 align="center">Using multiple processor cores in R-Projet</h1>
   
    <p align="center"><a href="http://yildizoglu.info">Murat Yildizoglu</a></p>
    <div id="container">
            <div class="entry-content">
        <span><p align="center">Published: 2012/01/16</span>
                 <hr>
        <p class="postbody"><p>My laptop is equipped with a Core i7 processor with 4 cores that can execute in parallel 8 processes. </p>

<p>My <a href="http://www.r-project.org/" title="The R Project for Statistical Computing">R-project</a> computations use only one single core, if I use the default instructions. I have ended up by thinking that it is a pity that other cores are just sitting idle (sort of), instead of contributing to the speed of my computations, even if I do not run yet really heavy ones in my research. As a consequence, I have started to look for an easy way to use all cores in <a href="http://www.r-project.org/" title="The R Project for Statistical Computing">R-project</a>. </p>

<p>And, indeed, there is an easy solution to this problem. It uses the <strong><a href="http://cran.r-project.org/web/packages/doMC/index.html" title="CRAN - Package doMC">doMC</a> library</strong>, and the instructions foreach and <strong><code>%dopar%</code></strong>.
For example, for computing linear models with different dependent variables and a given set of exogenous ones, one can do the following computations:</p>

<pre><code>library(doMC) # There are other parallel computing libraries
registerDoMC() # You must register one of them for foreach
getDoParWorkers() # Indicates you how many cores have been detected 
                  # by registerDoMC()
</code></pre>

<p>Suppose that you have a dataset called <code>mydata</code>, containing the dependent variables <code>y1, y2, y3</code>, and the independent variables, <code>x1,x2,x3</code>.</p>

<p>We can execute in parallel the estimation of linear models of each y on the set of independent variables, by executing the following code:</p>

<pre><code>myVariableList &lt;- c(\"y1\", \"y2\", \"y3\")  
results &lt;- foreach(i = 1:length(myVariableList), .errorhandling=\"stop\", .inorder=TRUE)
%dopar% {
    model &lt;- lm(as.formula(paste(myVariableList[i],\"~x1+x2+x3\")),data=mydata)
    return(model)
        }
</code></pre>

<p><strong><code>%dopar%</code></strong> executes these estimations on different cores, in parallel and a list of the estimated models is saved in the variable results.</p>

<p>We can now look at the characteristics of the estimated models, by printing them successively on the output of R:</p>

<p><code>for (i in 1:length(results)) { print(summary(results[[i]])) }</code></p>

<p>Voil√†!</p>

<p>Of course, this possibility is especially useful for more complex computations, like stepwise regressions with many independent variables, that can take some time, or regression trees with big datasets, etc.</p>
</p>
      </div>
      <hr>
      <p align="right"><a href="http://./">Back to the table of contents</a></p>
    </div>
<hr>
<p align='center' style="font-size:small"> (c) <a href="http://yildizoglu.info">Murat Yildizoglu</a>, 2014</p>
  </body>
</html>